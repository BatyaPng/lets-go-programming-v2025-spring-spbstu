.PHONY: generate build clean

generate:
	@echo "Generating version files..."
	@go generate
	@echo "// Code generated by Makefile; DO NOT EDIT." > version.go
	@echo "package main" >> version.go
	@echo "\nconst Version = \"1.2.3\"" >> version.go
	@sed "s/{{.Timestamp}}/$(shell date +'%Y-%m-%d %H:%M:%S')/" version.go.tmpl >> version.go

build: generate
	@echo "Building..."
	@go build -o main

clean:
	@rm -f main version.go